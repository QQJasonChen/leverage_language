# 🎨 自訂提示詞功能指南

## 概述

自訂提示詞功能讓您可以完全控制 AI 如何分析語言內容。您可以設計自己的提示詞模板，讓 AI 按照您的需求提供分析。

## 🚀 快速開始

1. **開啟設定頁面** - 點擊擴充功能的設定按鈕
2. **找到「🎨 自訂提示詞」** - 在 AI 設定區域中
3. **選擇「使用自訂提示詞」**
4. **輸入您的模板** - 在文字區域中輸入提示詞
5. **儲存設定** - 點擊儲存按鈕

## 📖 模板變數

在您的提示詞中可以使用以下變數：

| 變數 | 說明 | 範例 |
|------|------|------|
| `{{text}}` | 要分析的文本 | "Hello world" |
| `{{language}}` | 目標語言代碼 | "english", "dutch" |
| `{{languageName}}` | 語言名稱 | "English", "Dutch" |
| `{{isWord}}` | 是否為單詞 | true, false |
| `{{wordCount}}` | 字數 | 2 |
| `{{complexity}}` | 分析複雜度 | "simple", "medium" |

## 🔧 條件邏輯

使用類似 Mustache 的語法來處理條件內容：

### 正向條件
```
{{#isWord}}
這段內容只在分析單詞時顯示
{{/isWord}}
```

### 反向條件  
```
{{^isWord}}
這段內容只在分析句子時顯示
{{/isWord}}
```

## 💡 範例模板

### 1. 簡單學習模板
```
You are a {{languageName}} teacher for Chinese speakers. Analyze: "{{text}}"

## 🎯 分析
**中文翻譯：** [請提供中文翻譯]
**發音指導：** [IPA 音標和發音技巧]

{{#isWord}}
**詞性：** [名詞/動詞/形容詞等]
**用法：** [如何使用這個詞]
{{/isWord}}

{{^isWord}}
**語法結構：** [句子結構分析]
**重點詞彙：** [重要的語法或詞彙]
{{/isWord}}

保持回應對中文使用者有幫助和教育性。
```

### 2. 詳細分析模板
```
作為專業的 {{languageName}} 教師，請詳細分析：「{{text}}」

## 📚 完整分析

### 翻譯與含義
- **中文翻譯：** [準確翻譯]
- **使用語境：** [什麼時候使用]

{{#isWord}}
### 詞彙分析
- **詞性：** [詳細分類]
- **詞源：** [詞彙來源，如果相關]
- **變化形式：** [不同形式]
{{/isWord}}

{{^isWord}}
### 句子結構  
- **語法模式：** [句子結構分析]
- **主要成分：** [主語、動詞、賓語等]
- **複雜度：** 第 {{complexity}} 級
{{/isWord}}

### 學習建議
- **記憶技巧：** [如何記住]
- **常見錯誤：** [要避免的問題]
- **練習建議：** [建議的練習]

分析詞數：{{wordCount}}
```

### 3. 會話練習模板
```
你好！我是你的 {{languageName}} 會話夥伴。讓我們來處理：「{{text}}」

🎯 **快速翻譯：** [中文意思]

{{#isWord}}
🔤 **單詞重點：**
- 類型：[詞彙類別]
- 用法：[如何使用]
- 例句：[範例句子]
{{/isWord}}

{{^isWord}}
💬 **會話練習：**
- 模式：[語法結構]
- 類似短語：[3個變化]
- 回應建議：[如何回應]
{{/isWord}}

🚀 **輪到你了：** 試著用這個造句！

語言：{{languageName}} | 詞數：{{wordCount}}
```

## 🛡️ 安全與驗證

系統會自動檢查您的提示詞：

### ✅ 安全檢查
- 檢測潛在的提示詞注入攻擊
- 防止惡意指令
- 限制過長的提示詞

### ⚠️ 常見問題
- **必須包含 `{{text}}`** - 這是基本要求
- **避免系統指令** - 如 "忽略之前的指令"
- **保持合理長度** - 過長會增加 API 成本

## 🔄 回退機制

如果出現問題，系統會自動：
1. 使用預設的簡單提示詞
2. 在控制台顯示警告訊息
3. 確保功能繼續運作

## 💰 成本考量

- **較長的提示詞** = 更高的 API 成本
- **建議保持簡潔** 但詳細
- **測試不同長度** 找到平衡點

## 🧪 測試您的模板

1. 使用內建的測試頁面：`test-custom-prompts.html`
2. 測試不同的輸入文本
3. 檢查生成的提示詞
4. 驗證安全性

## 📝 最佳實務

### ✅ 推薦做法
- 明確指定回應語言（中文）
- 使用結構化的格式（標題、列表）
- 包含具體的指示
- 測試單詞和句子兩種情況

### ❌ 避免做法
- 過於複雜的條件邏輯
- 重複的指令
- 模糊的要求
- 忘記包含基本變數

## 🆘 故障排除

### 問題：提示詞沒有效果
- 檢查是否選擇了「使用自訂提示詞」
- 確保模板包含 `{{text}}` 變數
- 查看瀏覽器控制台的錯誤訊息

### 問題：安全驗證失敗
- 移除可疑的指令內容
- 避免使用系統關鍵字
- 檢查模板長度是否合理

### 問題：回應不如預期
- 簡化提示詞
- 添加更明確的指示
- 測試不同的措辭

## 🔄 版本更新

此功能會持續改進，未來可能包括：
- 更多模板變數
- 更好的條件邏輯
- 模板分享功能
- 視覺化編輯器

---

如果您有任何問題或建議，請聯繫開發團隊！